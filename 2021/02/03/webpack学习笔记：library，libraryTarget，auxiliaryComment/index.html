<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="æ¨¡å—åŒ–ä¸Webpackå±æ€§ library,libraryTargetçš„å…³è”"><meta name="keywords" content="webpackå­¦ä¹ ç¬”è®°"><meta name="author" content="èˆ’å°ç¦"><meta name="copyright" content="èˆ’å°ç¦"><title>æ¨¡å—åŒ–ä¸Webpackå±æ€§ library,libraryTargetçš„å…³è” | èˆ’å°ç¦çš„Blog</title><meta name="robots" content="noindex"><link rel="shortcut icon" href="http://p6.qhimg.com/t01f5a5270b7946b505.jpg"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">æ¨¡å—çš„å¼•å…¥æ–¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%EF%BC%9Ascript-%E6%A0%87%E7%AD%BE"><span class="toc-number">1.1.</span> <span class="toc-text">ä¼ ç»Ÿæ–¹å¼ï¼šscript æ ‡ç­¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AMD-%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">AMD æ–¹å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#commonJs-%E6%96%B9%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">commonJs æ–¹å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6-module-%E6%96%B9%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">ES6 module æ–¹å¼</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F%E5%8F%96%E5%86%B3%E4%BA%8E%E6%A8%A1%E5%9D%97%E5%A6%82%E4%BD%95%E5%AF%BC%E5%87%BA-%E6%9A%B4%E9%9C%B2"><span class="toc-number">2.</span> <span class="toc-text">å¼•å…¥æ–¹å¼å–å†³äºæ¨¡å—å¦‚ä½•å¯¼å‡º(æš´éœ²)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E7%9A%84-library-libraryTarget"><span class="toc-number">3.</span> <span class="toc-text">webpack çš„ library, libraryTarget</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#output-library"><span class="toc-number">3.1.</span> <span class="toc-text">output.library</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#output-libraryTarget"><span class="toc-number">3.2.</span> <span class="toc-text">output.libraryTarget</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%AF%BC%E5%87%BA%E6%96%B9%E5%BC%8F"><span class="toc-number">4.</span> <span class="toc-text">æ¨¡å—çš„å¯¼å‡ºæ–¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9A%B4%E9%9C%B2%E4%B8%BA%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F"><span class="toc-number">4.1.</span> <span class="toc-text">æš´éœ²ä¸ºä¸€ä¸ªå˜é‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cvar%E2%80%9D"><span class="toc-number">4.1.1.</span> <span class="toc-text">libraryTarget: â€œvarâ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cassign%E2%80%9D"><span class="toc-number">4.1.2.</span> <span class="toc-text">libraryTarget: â€œassignâ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%AF%B9%E8%B1%A1%E4%B8%8A%E8%B5%8B%E5%80%BC%E6%9A%B4%E9%9C%B2"><span class="toc-number">4.2.</span> <span class="toc-text">é€šè¿‡å¯¹è±¡ä¸Šèµ‹å€¼æš´éœ²</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cthis%E2%80%9D"><span class="toc-number">4.2.1.</span> <span class="toc-text">libraryTarget: â€œthisâ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cwindow%E2%80%9D"><span class="toc-number">4.2.2.</span> <span class="toc-text">libraryTarget: â€œwindowâ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cglobal%E2%80%9D"><span class="toc-number">4.2.3.</span> <span class="toc-text">libraryTarget: â€œglobalâ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Dcommonjs%E2%80%9D"><span class="toc-number">4.2.4.</span> <span class="toc-text">libraryTarget: â€commonjsâ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%AE%9A%E4%B9%89%E7%B3%BB%E7%BB%9F"><span class="toc-number">4.3.</span> <span class="toc-text">æ¨¡å—å®šä¹‰ç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Ccommonjs2%E2%80%9D"><span class="toc-number">4.3.1.</span> <span class="toc-text">libraryTarget: â€œcommonjs2â€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Camd%E2%80%9D"><span class="toc-number">4.3.2.</span> <span class="toc-text">libraryTarget: â€œamdâ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libraryTarget-%E2%80%9Cumd%E2%80%9D"><span class="toc-number">4.3.3.</span> <span class="toc-text">libraryTarget: â€œumdâ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="toc-number">4.4.</span> <span class="toc-text">å‚è€ƒæ–‡ç« ï¼š</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://p6.qhimg.com/t01f5a5270b7946b505.jpg"></div><div class="author-info__name text-center">èˆ’å°ç¦</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">54</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">12</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">13</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/webp.webp)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">èˆ’å°ç¦çš„Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">é¦–é¡µ</a><a class="site-page" href="/archives">å½’æ¡£</a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a><a class="site-page" href="/about">å…³äº</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> æœç´¢</span></a></span></div><div id="post-info"><div id="post-title">æ¨¡å—åŒ–ä¸Webpackå±æ€§ library,libraryTargetçš„å…³è”</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-02-03</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">webpackå­¦ä¹ ç¬”è®°</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p><code>webpack</code> æ˜¯å‰ç«¯ç›®å‰å¾ˆçƒ­é—¨çš„æ‰“åŒ…å·¥å…·ï¼Œç›¸ä¿¡å¤§å®¶åº”è¯¥åœ¨é¡¹ç›®ä¸­éƒ½ä½¿ç”¨è¿‡ã€‚å®ƒæœ‰å¾ˆå¤æ‚çš„é…ç½®é¡¹ã€‚å…¶ä¸­ <code>library</code>ï¼Œ<code>libraryTarget</code> å±æ€§å¤§å®¶å¯èƒ½å°±æ›´é™Œç”Ÿäº†ï¼Œå› ä¸ºåœ¨ä¸€èˆ¬çš„é¡¹ç›®ä¸­ä½¿ç”¨ <code>wabpacK</code> æ˜¯ä¸éœ€è¦å…³æ³¨ è¿™ä¸¤ä¸ªå±æ€§çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ˜¯å¼€å‘ç±»åº“ï¼Œå¦‚æœä½¿ç”¨webpack æ¥æ‰“åŒ…çš„è¯ï¼Œé‚£ä¹ˆ<code>library</code>ï¼Œ<code>libraryTarget</code> è¿™ä¸¤ä¸ªå±æ€§æ˜¯ä¸€å®šè¦äº†è§£çš„</p>
<blockquote>
<p>psï¼š ä¹Ÿä¸ä¸€å®šéè¦ä½¿ç”¨ <code>webpack</code> æ¥æ‰“åŒ…ï¼Œ æ‰“åŒ…çš„å·¥å…·å¾ˆå¤šï¼Œ<code> rollup</code> ä¹‹ç±»çš„éƒ½æ˜¯å¯ä»¥æ‰“åŒ…çš„ã€‚å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥ä¸æ‰“åŒ…çš„ï¼Œåªè¦ä½ å†™çš„æ¨¡å—(ç±»åº“)ç¬¦åˆè§„èŒƒå°±å¯ä»¥ã€‚</p>
</blockquote>
<p>è¿™ç¯‡æ–‡ç« å°†ä»ä¸‹é¢è¿™å‡ ä¸ªé—®é¢˜æ¥è¿›è¡Œè§£ç­”çš„</p>
<ul>
<li>æ¨¡å—ä¸€èˆ¬æ˜¯æ€ä¹ˆå¼•å…¥ï¼ˆæœ‰å¤šå°‘ç§æ–¹å¼ï¼‰;</li>
<li>ä¸ºä»€ä¹ˆæœ‰é‚£ä¹ˆå¤šç§å¼•å…¥çš„æ–¹å¼å‘¢ï¼Ÿ</li>
<li><code>webpack</code> çš„<code> library</code> å’Œ <code>libraryTarget</code> å±æ€§å…·ä½“æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿ</li>
<li><code>webpack</code> çš„ <code>library</code> å’Œ<code>libraryTarget</code>å±æ€§ èƒ½å°†æˆ‘ä»¬å†™çš„æ¨¡å—æš´éœ²æˆä»€ä¹ˆæ ·çš„ï¼Ÿ</li>
</ul>
<span id="more"></span>

<h1 id="æ¨¡å—çš„å¼•å…¥æ–¹å¼"><a href="#æ¨¡å—çš„å¼•å…¥æ–¹å¼" class="headerlink" title="æ¨¡å—çš„å¼•å…¥æ–¹å¼"></a>æ¨¡å—çš„å¼•å…¥æ–¹å¼</h1><p>å½“æˆ‘ä»¬å¼•ç”¨åˆ«äººå¼€å‘çš„æ¨¡å—æ—¶æœ‰å‡ ç§å¼•å…¥æ”¾å…¥çš„æ–¹å¼ï¼Ÿï¼Œå‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå¼€å‘å¥½çš„æ¨¡å—<code>demo</code>ã€‚é‚£ä¹ˆå¦‚ä½•ä½¿ç”¨å®ƒå‘¢ï¼Ÿ</p>
<h2 id="ä¼ ç»Ÿæ–¹å¼ï¼šscript-æ ‡ç­¾"><a href="#ä¼ ç»Ÿæ–¹å¼ï¼šscript-æ ‡ç­¾" class="headerlink" title="ä¼ ç»Ÿæ–¹å¼ï¼šscript æ ‡ç­¾"></a>ä¼ ç»Ÿæ–¹å¼ï¼šscript æ ‡ç­¾</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;demo.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  demo();</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="AMD-æ–¹å¼"><a href="#AMD-æ–¹å¼" class="headerlink" title="AMD æ–¹å¼"></a>AMD æ–¹å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">&#x27;demo&#x27;</span>],<span class="function"><span class="keyword">function</span>(<span class="params">demo</span>) </span>&#123;  </span><br><span class="line">  demo();</span><br><span class="line">&#125;)  </span><br></pre></td></tr></table></figure>

<h2 id="commonJs-æ–¹å¼"><a href="#commonJs-æ–¹å¼" class="headerlink" title="commonJs æ–¹å¼"></a>commonJs æ–¹å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> demo = <span class="built_in">require</span>(<span class="string">&#x27;demo&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">demo();</span><br></pre></td></tr></table></figure>

<h2 id="ES6-module-æ–¹å¼"><a href="#ES6-module-æ–¹å¼" class="headerlink" title="ES6 module æ–¹å¼"></a>ES6 module æ–¹å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> demo <span class="keyword">from</span> <span class="string">&#x27;demo&#x27;</span>;</span><br><span class="line"></span><br><span class="line">demo();</span><br></pre></td></tr></table></figure>



<p>ä¸ºä»€ä¹ˆè¿™äº›æ¨¡å—èƒ½æ”¯æŒä¸ç”¨çš„æ–¹å¼å¼•ç”¨å‘¢ï¼Ÿ æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<hr>
<h1 id="å¼•å…¥æ–¹å¼å–å†³äºæ¨¡å—å¦‚ä½•å¯¼å‡º-æš´éœ²"><a href="#å¼•å…¥æ–¹å¼å–å†³äºæ¨¡å—å¦‚ä½•å¯¼å‡º-æš´éœ²" class="headerlink" title="å¼•å…¥æ–¹å¼å–å†³äºæ¨¡å—å¦‚ä½•å¯¼å‡º(æš´éœ²)"></a>å¼•å…¥æ–¹å¼å–å†³äºæ¨¡å—å¦‚ä½•å¯¼å‡º(æš´éœ²)</h1><p>ä¸Šé¢å¦‚ä½•å¼•å…¥ä¹Ÿæå‡ºäº†é—®é¢˜ï¼Œä¸ºä»€ä¹ˆæ¨¡å—æ”¯æŒä¸åŒçš„å¼•å…¥ï¼Ÿå…¶å®è¿™å–å†³äºæ¨¡å—ä¹‹å‰çš„æ˜¯å¦‚ä½•å¯¼å‡ºçš„ã€‚</p>
<p>æˆ‘ä»¬ä¸¾ä¸ªåˆ—å­ï¼š</p>
<p>æˆ‘ä»¬å¼€å‘ä¸€ä¸ª æ¨¡å— demoã€‚è¿™ä¸ªæ¨¡å—æŠ›å‡ºä¸€ä¸ª <code>getName</code> å‡½æ•°ï¼Œå‡½æ•°é‡Œé¢æ‰“å° â€shuliqiâ€œå­—ç¬¦ä¸²ã€‚</p>
<p>åŸºæœ¬çš„é¡¹ç›®ç»“æ„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|--src</span><br><span class="line">  |--index.js</span><br><span class="line">  |--index.html</span><br><span class="line">|--webpack.config.js</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°å®‰è£… <code>webpack</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev  webpack@5.19.0 </span><br></pre></td></tr></table></figure>

<p>å®‰è£… <code>webpack-cli</code>(ç›®çš„æ˜¯ä¸ºäº†åœ¨å‘½ä»¤è¡Œä¸­æ˜¯ç”¨ <code>webpack</code> å‘½ä»¤)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D webpack-cli</span><br></pre></td></tr></table></figure>

<p>package.json æ–‡ä»¶çš„<code> scripts</code>å­—æ®µæ”¹æˆï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;build&quot;</span>: <span class="string">&quot;webpack --config webpack.config.js&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;shuliqi&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>webpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// æ‰“åŒ…æ–‡ä»¶åå­—</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;default.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/default.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    demo ç¤ºä¾‹</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">   getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„ç»“æ„ç›®å½•å˜æˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|--src</span><br><span class="line">  |--index.js</span><br><span class="line">  |--index.html</span><br><span class="line">|--webpack.config.js</span><br><span class="line">|--package.json</span><br><span class="line">|--package-lock.json</span><br><span class="line">|-node_modules</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬åœ¨æ ¹ç›®å½•æ‰§è¡Œ <code>webpack</code> æ‰“åŒ…å‘½ä»¤(package.json æ–‡ä»¶ script å­—æ®µæˆ‘ä»¬å®šä¹‰å¥½çš„)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…å®Œä¹‹åä¼šå‡ºç° <code>dist</code> æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ <code>default.js</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">|--dist</span><br><span class="line">  |--default.js</span><br><span class="line">|--src</span><br><span class="line">  |--index.js</span><br><span class="line">  |--index.html</span><br><span class="line">|--webpack.config.js</span><br><span class="line">|--package.json</span><br><span class="line">|--package-lock.json</span><br><span class="line">|-node_modules</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨æµè§ˆå™¨æ‰“ <code>index.html</code></p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/1.png" class="">

<p>å‘ç°æŠ¥é”™ï¼šindex.html:12 Uncaught ReferenceError: getName is not defined</p>
<p>ä¸ºä»€ä¹ˆä¼šæŠ¥é”™å‘¢ï¼Ÿ</p>
<p>æ˜¾ç„¶é¡µé¢åœ¨è°ƒç”¨ <code>getName</code>çš„æ—¶å€™ï¼Œåœ¨ window ä¸Šå¯»æ‰¾ <code>getName</code>æ–¹æ³•ï¼Œä½†æ˜¯æ¨¡å—åŒ–çš„å¼€å‘å‘¢ï¼Œæ˜¯æ‹’ç»ä¸€åˆ‡çš„å…¨å±€å˜é‡çš„ï¼Œæ‰€ä»¥åœ¨å…¨å±€æ‰¾ä¸åˆ°è¯¥å¯¹è±¡ã€‚æ‰€ä»¥ä½¿ç”¨ <code>script</code> æ ‡ç­¾å¼•å…¥è¯¥æ¨¡å—æ˜¯è®¿é—®ä¸åˆ° <code>getName</code>æ–¹æ³•çš„ã€‚</p>
<p>é‚£å¦‚ä½•æ ¹æ®ä¸ç”¨çš„å¼•å…¥éœ€è¦æ¥å†³å®šå¦‚ä½•å¯¼å‡ºæ¨¡å—å‘¢ï¼Ÿ å¦‚æœæ˜¯ä½¿ç”¨<code> webpack</code> å¯¹ç±»åº“è¿›è¡Œæ‰“åŒ…çš„è¯ï¼Œé‚£ä¹ˆ<code> library</code>ï¼Œ<code>libraryTarget</code> è¿™ä¸¤ä¸ªå±æ€§æ˜¯å¯ä»¥å†³å®šå¦‚ä½•å¯¼å‡ºç±»åº“çš„ã€‚</p>
<blockquote>
<p>PS: å½“ç„¶ä¸æ˜¯åªæœ‰webpack å¯ä»¥æ‰“åŒ…ï¼Œæƒ³ rollup ä¹‹ç±»çš„éƒ½æ˜¯å¯ä»¥æ‰“åŒ…çš„</p>
</blockquote>
<hr>
<h1 id="webpack-çš„-library-libraryTarget"><a href="#webpack-çš„-library-libraryTarget" class="headerlink" title="webpack çš„ library, libraryTarget"></a>webpack çš„ library, libraryTarget</h1><p><code>webpac</code>kçš„<code>output </code>çš„é…ç½®é¡¹<code> library</code> å’Œ<code>libraryTarget</code>å¯ä»¥å†³å®šå¦‚ä½•å¯¼å‡ºæ¨¡å—ã€‚</p>
<h2 id="output-library"><a href="#output-library" class="headerlink" title="output.library"></a>output.library</h2><p>è¿™ä¸ªå­—æ®µæ”¯æŒ <code>string</code> å’Œ <code>object</code>ç±»å‹çš„å€¼</p>
<blockquote>
<p>æ³¨æ„ï¼šwebpack 3.1.0 æ‰æ”¯æŒ object ç±»å‹çš„ï¼Œå¹¶ä¸”è¿™ä¸ªä»…é™ä¸ libraryTarget: â€œumdâ€ æ—¶ä½¿ç”¨</p>
</blockquote>
<p><code>output.library</code> çš„å€¼è¢«å¦‚ä½•ä½¿ç”¨æ˜¯æ ¹æ® <code>output.libraryTarget</code> çš„å–å€¼ä¸åŒè€Œä¸ç”¨.ã€‚</p>
<h2 id="output-libraryTarget"><a href="#output-libraryTarget" class="headerlink" title="output.libraryTarget"></a>output.libraryTarget</h2><p>è¿™ä¸ªå­—æ®µæ”¯æŒ<code> string</code> ç±»å‹çš„å€¼ï¼Œã€‚é»˜è®¤å€¼: <code>var</code></p>
<p>è¿™ä¸ªé…ç½®çš„ä½œç”¨æ˜¯æ§åˆ¶ <code>webpack</code> æ‰“åŒ…çš„å†…å®¹æ˜¯å¦‚ä½•æš´éœ²çš„ï¼ˆå³ä¸Šé¢è¯´çš„å¦‚ä½•å¯¼å‡ºçš„ï¼‰</p>
<hr>
<h1 id="æ¨¡å—çš„å¯¼å‡ºæ–¹å¼"><a href="#æ¨¡å—çš„å¯¼å‡ºæ–¹å¼" class="headerlink" title="æ¨¡å—çš„å¯¼å‡ºæ–¹å¼"></a>æ¨¡å—çš„å¯¼å‡ºæ–¹å¼</h1><p>æ ¹æ®ä»¥ä¸Šæˆ‘ä»¬çŸ¥é“ <code>webpack</code> çš„ <code>library</code>,<code> libraryTarget</code> å¯ä»¥å†³å®šå¦‚ä½•å¯¼å‡ºæ¨¡å—ï¼Œé‚£ä¹ˆå¯ä»¥å¯¼å‡ºï¼ˆæš´éœ²ï¼‰ä»€ä¹ˆæ ·çš„ç±»åº“å‘¢ï¼Ÿ </p>
<h2 id="æš´éœ²ä¸ºä¸€ä¸ªå˜é‡"><a href="#æš´éœ²ä¸ºä¸€ä¸ªå˜é‡" class="headerlink" title="æš´éœ²ä¸ºä¸€ä¸ªå˜é‡"></a>æš´éœ²ä¸ºä¸€ä¸ªå˜é‡</h2><p>å¦‚æœå°†<code> libraryTarget</code> è®¾ç½®ä¸º <code>var</code>/ <code>assign</code>, webpack ä¼šæŠŠæ¨¡å—è¿”å›çš„å€¼ï¼ˆæ— è®ºæš´éœ²çš„æ˜¯ä»€ä¹ˆï¼‰ç»‘å®šåˆ°ä¸€ä¸ªç”± <code>output.library</code>æŒ‡å®šçš„å˜é‡ä¸Šã€‚è¿™ä¸¤ç§å¯¼å‡ºæ–¹å¼ä½¿ç”¨<strong>ä¼ ç»Ÿæ–¹å¼ï¼šscript æ ‡ç­¾æ–¹å¼</strong> æ¥å¼•å…¥çš„ã€‚</p>
<h3 id="libraryTarget-â€œvarâ€"><a href="#libraryTarget-â€œvarâ€" class="headerlink" title="libraryTarget: â€œvarâ€"></a>libraryTarget: â€œvarâ€</h3><p>è¿™æ˜¯<code> libraryTarget</code> çš„é»˜è®¤å€¼ã€‚å½“æ¨¡å—åŠ è½½å®Œæˆæ—¶å€™ï¼Œæ¨¡å—çš„çš„è¿”å›å€¼ï¼ˆå…¥å£èµ·ç‚¹çš„ä»»ä½•å¯¼å‡ºå€¼ï¼‰å°†åˆ†é…åˆ°ä¸€ä¸ªä½¿ç”¨ var å£°æ˜çš„å˜é‡ä¸Šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_: æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">// å˜é‡ demo ä½¿ç”¨ var å£°æ˜ </span></span><br><span class="line"><span class="keyword">var</span> demo = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>è¿˜æ˜¯åŸºäºä»¥ä¸Šä¾‹å­ï¼Œç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶  <code>webpack-config-var.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// æ‰“åŒ…çš„æ–‡ä»¶å</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-var.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼åˆ†é…åˆ°ä¸€ä¸ªä½¿ç”¨var å£°æ˜çš„å˜é‡ä¸Šï¼Œ è¯¥å˜é‡ç”±  library å†³å®š</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;var&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json çš„ <code>script</code> æ·»åŠ ä¸€æ¡å¿ƒçš„æ‰“åŒ…å‘½ä»¤</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-var&quot;</span>:  <span class="string">&quot;webpack --config webpack-config-var.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¹ç›®å½•æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run  build-var</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>webpack-var.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> demo;</span><br><span class="line">demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šæ¨¡å—çš„è¿”å›å€¼åˆ†é…åˆ°äº† ä½¿ç”¨ <code>var</code> å£°æ˜çš„å˜é‡ <code>demo</code> ä¸Šã€‚</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>å¯ä»¥é€šè¿‡ ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥åŠ è½½ä½¿ç”¨</p>
<p>åœ¨åŸæ¥çš„ç›®å½•ç»“æ„ä¸Š<code> src</code> ç›®å½•ä¸‹æ·»åŠ  <code>index-var.html</code></p>
<p>index-var.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- ä¼ ç»Ÿå¼•å…¥æ–¹å¼ï¼š`script` æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-var.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    demo ç¤ºä¾‹</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(demo);</span></span><br><span class="line"><span class="javascript">    demo.getName();</span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬æ‰“å¼€ <code>index.html</code>:</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/2.png" class="">

<p>ä»æˆªå›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œ æˆ‘ä»¬æ˜¯èƒ½è®¿é—®åˆ°æš´éœ²å‡ºçš„<code> demo</code> æ¨¡å— åŠå…¶å®ƒ <code>getName</code>æ–¹æ³•çš„ã€‚</p>
<p>æ³¨æ„ï¼š å¦‚æœæ²¡æœ‰è®¾ç½® libraryï¼Œé‚£ä¹ˆæ‰“åŒ…å°†ä¼šç›´æ¥æŠ¥é”™</p>
<hr>
<h3 id="libraryTarget-â€œassignâ€"><a href="#libraryTarget-â€œassignâ€" class="headerlink" title="libraryTarget: â€œassignâ€"></a>libraryTarget: â€œassignâ€</h3><p>ä½¿ç”¨è¿™ä¸ªè®¾ç½®ï¼Œ <code>webpack</code>æŠŠæ¨¡å—è¿”å›å€¼åˆ†é…ç»™ä¸€ä¸ªæ²¡æœ‰ä½¿ç”¨ var å£°æ˜çš„å˜é‡ï¼Œå¦‚æœè¿™ä¸ªå˜é‡åœ¨æ²¡æœ‰å¼•å…¥ä½œç”¨åŸŸæå‰ç”³è¯·è¿‡ï¼Œé‚£ä¹ˆå°†ä¼šæŒ‚è½½åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œ<strong>è¿™ä¸ªè®¾ç½®å¯èƒ½ä¼šé‡æ–°åˆ†é…å…¨å±€ä¸­å·²ç»å­˜åœ¨çš„å€¼</strong> ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_: æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">// å˜é‡ demo æ²¡æœ‰ä½¿ç”¨ var å£°æ˜ </span></span><br><span class="line">demo = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>è¿˜æ˜¯åŸºäºä»¥ä¸Šä¾‹å­ï¼Œç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶  <code>webpack-config-assign.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// æ‰“åŒ…æ–‡ä»¶åå­—</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-assign.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼å°†åˆ†é…åˆ°ä¸€ä¸ªæ²¡æœ‰ä½¿ç”¨varå£°æ˜çš„å˜é‡ä¸Šï¼Œå˜é‡ç”± library æ§åˆ¶</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;assign&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json çš„ <code>script</code> å­—æ®µæ·»åŠ ä¸€æ¡å¿ƒçš„æ‰“åŒ…å‘½ä»¤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-assgin&quot;</span>: <span class="string">&quot;webpack --config webpack-config-assigin.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¹ç›®å½•æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-assign</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>webpack-assign.js</code>æ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šæ¨¡å—çš„è¿”å›å€¼åˆ†é…åˆ°äº†æ²¡æœ‰ä½¿ç”¨<code>var</code> å£°æ˜çš„å˜é‡ <code>demo</code> ä¸Šã€‚</p>
<p><strong>å¼•ç”¨</strong></p>
<p>å¦‚æœä½¿ç”¨çš„è¯ï¼Œ å¯ä»¥é€šè¿‡ ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥å¼•ç”¨ã€‚</p>
<p>åœ¨åŸæ¥çš„ç›®å½•ç»“æ„ä¸Š<code> src</code> ç›®å½•ä¸‹æ·»åŠ  <code>index-assign.html</code></p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- ä¼ ç»Ÿå¼•å…¥æ–¹å¼ï¼š`script` æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-assign.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    assign é…ç½®</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(demo);</span></span><br><span class="line"><span class="javascript">    demo.getName();</span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€æˆ‘ä»¬çš„ html æ–‡ä»¶ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/3.png" class="">

<p>æˆ‘ä»¬èƒ½æ‰“å°å‡ºæ¨¡å—<code>demo</code>ï¼ŒåŠå¯ä»¥ä½¿ç”¨å®ƒçš„<code>getName</code>æ–¹æ³•</p>
<p><strong>æ³¨æ„ï¼š</strong>ä½†æ˜¯å¦‚æœåœ¨åŠ è½½æ¨¡å—ä¹‹å‰å·²ç»å­˜åœ¨å˜é‡ï¼Œ é‚£ä¹ˆåŠ è½½æ¨¡å—ä¹‹åï¼Œ  ä¼šè¦†ç›–å·²å­˜åœ¨çš„å˜é‡</p>
<p>åœ¨ <code>src</code> ç›®å½•ä¸­æ·»åŠ  <code>index.cover-assign.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="comment">// å…¨å±€å·²ç»å­˜åœ¨çš„å˜é‡ demo</span></span></span><br><span class="line"><span class="javascript">      demo = <span class="string">&quot;æˆ‘æ˜¯demo&quot;</span>;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(demo);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- ä¼ ç»Ÿå¼•å…¥æ–¹å¼ï¼š`script` æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-assign.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    assign é…ç½®:</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ä½†æ˜¯å¦‚æœåœ¨åŠ è½½æ¨¡å—ä¹‹å‰å·²ç»å­˜åœ¨å˜é‡ï¼Œ é‚£ä¹ˆåŠ è½½æ¨¡å—ä¹‹åï¼Œ  ä¼šè¦†ç›–å·²å­˜åœ¨çš„å˜é‡</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// åŠ è½½å®Œæˆ‘ä»¬çš„æ¨¡å—ä¹‹åï¼Œ ä¼šè¦†ç›–å…¨å±€ä¸­å·²ç»å­˜åœ¨çš„å˜é‡ demo</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(demo)</span></span><br><span class="line"><span class="javascript">    demo.getName();</span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€HTMLæ–‡ä»¶ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/4.png" class="">

<p>ç»“æœè¯´æ˜ï¼šæˆ‘ä»¬åŠ è½½æ¨¡å—ä¹‹åçš„ é‡æ–°èµ‹å€¼äº†ä¹‹å‰çš„å˜é‡ <code>demo</code></p>
<hr>
<h2 id="é€šè¿‡å¯¹è±¡ä¸Šèµ‹å€¼æš´éœ²"><a href="#é€šè¿‡å¯¹è±¡ä¸Šèµ‹å€¼æš´éœ²" class="headerlink" title="é€šè¿‡å¯¹è±¡ä¸Šèµ‹å€¼æš´éœ²"></a>é€šè¿‡å¯¹è±¡ä¸Šèµ‹å€¼æš´éœ²</h2><p>ä»¥ä¸‹ çš„å››ä¸ªè®¾ç½®é€‰é¡¹ <code>webpack</code> ä¼šå°†æ¨¡å—çš„è¿”å›å€¼ï¼ˆå…¥å£èµ·ç‚¹çš„ä»»ä½•å¯¼å‡ºå€¼ï¼‰èµ‹å€¼ç»™ä¸€ä¸ªç‰¹å®šå¯¹è±¡çš„å±æ€§ä¸Š; è¿™ä¸ªå¯¹è±¡<code>output.libraryTarget</code> æŒ‡å®šï¼Œè¿™ä¸ªå±æ€§ç”± <code>output.library</code>æŒ‡å®šã€‚å¦‚æœ<code>output.library</code>æ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¹ˆé»˜è®¤è¡Œä¸ºæ˜¯å°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ°å¯¹è±¡ä¸­ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š <code>output.library</code>æ²¡æœ‰æŒ‡å®šçš„æ—¶å€™ï¼Œ webpackå¹¶ä¸ä¼šæ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŸäº›å±æ€§è®¾ç½®ï¼Œå³ä¼šå‘ç”Ÿè¦†ç›–è¡Œä¸º</p>
</blockquote>
<h3 id="libraryTarget-â€œthisâ€"><a href="#libraryTarget-â€œthisâ€" class="headerlink" title="libraryTarget: â€œthisâ€"></a>libraryTarget: â€œthisâ€</h3><p>è¿™ä¸ªé…ç½®é¡¹è¡¨ç¤º æ¨¡å—çš„è¿”å›å€¼å°†åˆ†é…ç»™<code>this</code> å¯¹è±¡ çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ç”±<code>output.library</code>æŒ‡å®šï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§å°†ç›´æ¥åˆ†é…åˆ° <code>this</code> å¯¹è±¡ä¸Šï¼ˆå¹¶ä¸”<code>webpack</code>å¹¶ä¸ä¼šæ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŸäº›å±æ€§è®¾ç½®ï¼Œå³ä¼šå‘ç”Ÿè¦†ç›–è¡Œä¸ºï¼‰</p>
<p>ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå½“æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œé‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼ä¼šè¢«åˆ†é…åˆ° this å¯¹è±¡çš„ å±æ€§ï¼ˆlibraryå†³å®šå±æ€§ï¼‰ä¸Š ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_:æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="built_in">this</span>[<span class="string">&#x27;demo&#x27;</span>] = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>åœ¨ä¸Šé¢ä¾‹å­çš„åŸºç¡€ä¸Šï¼Œ æˆ‘ä»¬åœ¨æ ¹ç›®å½•æ·»åŠ ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶ <code>webpack-config-this.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// æ‰“åŒ…åçš„æ–‡ä»¶åå­—</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-this.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼åˆ†é…åœ¨ this å¯¹è±¡çš„ demo å±æ€§ä¸Š</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;this&#x27;</span>,</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ–‡ä»¶çš„<code>script</code>å­—æ®µæ·»åŠ æ–°ä¸€æ¡æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-this&quot;</span>: <span class="string">&quot;webpack --config webpack-config-this.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¹ç›®å½•æ‰§è¡Œ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-<span class="built_in">this</span></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…çš„æ–‡ä»¶ <code>webpack-this.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,t</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            t.r(r),</span><br><span class="line">            t.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>o</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[o])</span><br><span class="line">            <span class="keyword">return</span> r[o].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[o] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[o](n, n.exports, t),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> r)</span><br><span class="line">            t.o(r, o) &amp;&amp; !t.o(e, o) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, o, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[o]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    t.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    t.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    t(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šæ¨¡å—çš„è¿”å›å€¼åˆ†é…ç»™äº†<code>this</code>å¯¹è±¡çš„ <code>demo</code>å±æ€§</p>
<p><strong>å¼•ç”¨æ¨¡å—ï¼š</strong></p>
<p>å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥å¼•ç”¨æˆ‘ä»¬çš„æ¨¡å—ã€‚</p>
<p><code>src</code>ç›®å½•ä¸‹æ·»åŠ  <code>index-this.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-this.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   this é…ç½®</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> demo = <span class="built_in">this</span>.demo;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(demo)</span></span><br><span class="line"><span class="javascript">    demo.getName();</span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> åœ¨æµè§ˆå™¨æ‰“å¼€HTMLï¼Œ ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/5.png" class="">

<p>ä»æˆªå›¾å¯ä»¥çœ‹å‡º æˆ‘ä»¬åœ¨<code>this</code>å¯¹è±¡èƒ½æ‰¾åˆ° <code>demo</code> æ¨¡å—</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° <code>this</code>å¯¹è±¡ä¸­ã€‚</p>
<p>æ·»åŠ æ–°çš„é…ç½®æ–‡ä»¶ <code>webpack-config-this-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; ModuleFilenameHelpers &#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>:<span class="string">&#x27;webpack-this-cover.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `this`å¯¹è±¡ä¸­ã€‚</span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;this&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>packge.json æ–‡ä»¶çš„ <code>script</code> å­—æ®µæ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-this-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-this-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæˆ‘ä»¬æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-<span class="built_in">this</span>-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>webpack-this-cover.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> r)</span><br><span class="line">        e[o] = r[o];</span><br><span class="line">    r.__esModule &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(<span class="built_in">this</span>, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>æ·»åŠ æ–°çš„æ–‡ä»¶ <code>index-this-cover.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-this-cover.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   this é…ç½®:</span><br><span class="line">   <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">   å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `this`å¯¹è±¡ä¸­</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ HTML ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/6.png" class="">

<p>ç»“æœï¼š æ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° <code>this</code>å¯¹è±¡ä¸­ã€‚æ‰€æœ‰å¯ä»¥ç›´æ¥æ‰§è¡Œ<code>getName</code>æ–¹æ³•</p>
<hr>
<h3 id="libraryTarget-â€œwindowâ€"><a href="#libraryTarget-â€œwindowâ€" class="headerlink" title="libraryTarget: â€œwindowâ€"></a>libraryTarget: â€œwindowâ€</h3><p>è¿™ä¸ªé…ç½®é¡¹è¡¨ç¤ºæ¨¡å—çš„è¿”å›å€¼å°†åˆ†é…ç»™ <code>window</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ç”±<code>output.library</code>æŒ‡å®šï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§å°†ç›´æ¥åˆ†é…åˆ° <code>window</code> å¯¹è±¡ä¸Šï¼ˆå¹¶ä¸”<code>webpack</code>å¹¶ä¸ä¼šæ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŸäº›å±æ€§è®¾ç½®ï¼Œå³ä¼šå‘ç”Ÿè¦†ç›–è¡Œä¸ºï¼‰</p>
<p>ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå½“æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œé‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼ä¼šè¢«åˆ†é…åˆ° <code>window</code> å¯¹è±¡çš„ å±æ€§ï¼ˆlibraryå†³å®šå±æ€§ï¼‰ä¸Š ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_:æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="built_in">window</span>[<span class="string">&#x27;demo&#x27;</span>] = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>æ·»åŠ æ–°çš„é…ç½®æ–‡ä»¶ <code>webpack-config-var.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;/src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>:<span class="string">&#x27;webpack-window.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼åˆ†é…åˆ° window å¯¹è±¡çš„ demo å±æ€§ä¸Š</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;window&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ–‡ä»¶çš„<code>script</code>å­—æ®µæ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-window&quot;</span>: <span class="string">&quot;webpack --config webpack-config-window.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-window</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶  <code>webpack-window.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,o,r</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            r.r(o),</span><br><span class="line">            r.d(o, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , o = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o[t])</span><br><span class="line">            <span class="keyword">return</span> o[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = o[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, r),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r.d = <span class="function">(<span class="params">e,o</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> o)</span><br><span class="line">            r.o(o, t) &amp;&amp; !r.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: o[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r.o = <span class="function">(<span class="params">e,o</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, o),</span><br><span class="line">    r.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šæ¨¡å—çš„è¿”å›å€¼ åˆ†é…åˆ°äº†<code> window</code> çš„ <code>demo</code> å±æ€§ä¸Šã€‚</p>
<p><strong>å¼•ç”¨æ¨¡å—ï¼š</strong></p>
<p>å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥å¼•ç”¨æˆ‘ä»¬çš„ç±»åº“ã€‚</p>
<p>index-window.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¼ ç»Ÿå¼•å…¥æ–¹å¼ï¼š`script` æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./dist/main.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    demo ç¤ºä¾‹</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    demo.getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€index.html</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/7.png" class="">

<p>ç»“æœï¼šæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨<code>window</code> ä¸Šè·å–<code>demo</code>; è¯´æ˜æ¨¡å—æ¨¡å—çš„è¿”å›å€¼å°†åˆ†é…ç»™ window çš„ demo å±æ€§ä¸Šã€‚</p>
<hr>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° <code>window</code> å¯¹è±¡ä¸­ã€‚</p>
<p>æ·»åŠ ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶ï¼šwebpack-config-window-cover.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>:<span class="string">&#x27;webpack-window-cover.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `window`å¯¹è±¡ä¸­ã€‚</span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;window&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ–‡ä»¶<code>script</code>æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-window-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-window-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæˆ‘ä»¬æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-<span class="built_in">window</span>-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e, o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> r <span class="keyword">in</span> o)</span><br><span class="line">        e[r] = o[r];</span><br><span class="line">    o.__esModule &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(<span class="built_in">window</span>, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,o,r</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            r.r(o),</span><br><span class="line">            r.d(o, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , o = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o[t])</span><br><span class="line">            <span class="keyword">return</span> o[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = o[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, r),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r.d = <span class="function">(<span class="params">e,o</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> o)</span><br><span class="line">            r.o(o, t) &amp;&amp; !r.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: o[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r.o = <span class="function">(<span class="params">e,o</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, o),</span><br><span class="line">    r.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥å¼•ç”¨æˆ‘ä»¬çš„ç±»åº“ã€‚</p>
<p>index-window-cover.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-window-cover.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   window é…ç½®</span><br><span class="line">   <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">   å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° window å¯¹è±¡ä¸­ã€‚</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€HTML æ–‡ä»¶ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/8.png" class="">

<p>ç»“æœè¯´æ˜ï¼šæ²¡æœ‰è®¾ç½® libraryã€‚demo æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§ï¼ˆä¾‹å¦‚: <code>getName</code>ï¼‰éƒ½ä¼šè¢«åˆ†é…åˆ° <code>window</code>å¯¹è±¡ä¸­ï¼ˆå³ æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨ <code>getName</code>æ–¹æ³•çš„åŸå› ï¼‰</p>
<h3 id="libraryTarget-â€œglobalâ€"><a href="#libraryTarget-â€œglobalâ€" class="headerlink" title="libraryTarget: â€œglobalâ€"></a>libraryTarget: â€œglobalâ€</h3><p>è¿™ä¸ªé…ç½®é¡¹è¡¨ç¤ºæ¨¡å—çš„çš„è¿”å›å€¼å°†åˆ†é…ç»™Â·<code>global</code> å¯¹è±¡ çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ç”±<code>output.library</code>æŒ‡å®šï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§å°†ç›´æ¥åˆ†é…åˆ° <code>global</code> å¯¹è±¡ä¸Šï¼ˆå¹¶ä¸”<code>webpack</code>å¹¶ä¸ä¼šæ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŸäº›å±æ€§è®¾ç½®ï¼Œå³ä¼šå‘ç”Ÿè¦†ç›–è¡Œä¸ºï¼‰</p>
<p>ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå½“æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œé‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼ä¼šè¢«åˆ†é…åˆ° <code>global</code> å¯¹è±¡çš„ å±æ€§ï¼ˆlibraryå†³å®šå±æ€§ï¼‰ä¸Š ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_:æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="built_in">global</span>[<span class="string">&quot;demo&quot;</span>] = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>æ·»åŠ æ–°çš„é…ç½®æ–‡ä»¶ <code>webpack-config-global.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-global.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„çš„è¿”å›å€¼å°†åˆ†é…ç»™ globalå¯¹è±¡ demo å±æ€§ä¸Š</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;global&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ–‡ä»¶ <code>script</code> æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-global&quot;</span>: <span class="string">&quot;webpack --config webpack-config-global.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-<span class="built_in">global</span></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>webpack-global.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">self.demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šæˆ‘ä»¬çš„æ¨¡å—ç»‘å®šåœ¨äº† <code>self</code> ä¸Šã€‚ æœ‰çš„åŒå­¦å¯èƒ½ä¼šé—®ï¼Œ ä¸æ˜¯è¯¥ç»‘å®šåœ¨ <code>global</code> ä¸Šå—ï¼Ÿ</p>
<p>å…¶å®ï¼š</p>
<blockquote>
<p>é€šå¸¸è®¨è®ºå…¨å±€å¯¹è±¡æ—¶ï¼Œå¾ˆå°‘ä¼šåŒºåˆ†å…¨å±€å¯¹è±¡æ˜¯ global å¯¹è±¡ï¼Œè¿˜æ˜¯ global å¯¹è±¡ä¸Šçš„å±æ€§ã€‚ç”±äºä½œç”¨åŸŸé“¾çš„åŸå› ï¼Œglobal å¯¹è±¡ä¸Šçš„å±æ€§éƒ½å¯ä»¥ç›´æ¥åœ¨å…¨å±€è®¿é—®ã€‚ä¸åŒçš„ JavaScript ç¯å¢ƒå­˜åœ¨ä¸åŒçš„å…¨å±€å¯¹è±¡ï¼Œä¾‹å¦‚æµè§ˆå™¨ä¸­çš„ <code>window</code>ã€<code>self</code>ã€<code>location</code>ã€<code>navigator</code>ã€<code>event</code>ï¼ŒNode.js ä¸­çš„ <code>global</code>ã€<code>module</code>ã€<code>exports</code>ã€<code>process</code> ç­‰ã€‚è®¿é—®å®¿ä¸»ç¯å¢ƒä¸­ä¸å­˜åœ¨çš„å…¨å±€å˜é‡ä¼šäº§ç”Ÿ <code>ReferenceError</code> é”™è¯¯ï¼ˆå³è®¿é—®æœªå£°æ˜å˜é‡ï¼‰ã€‚</p>
</blockquote>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„å¼•å…¥æ–¹å¼ï¼ˆscriptæ ‡ç­¾ï¼‰æ¥å¼•ç”¨æˆ‘ä»¬çš„ç±»åº“ã€‚</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¼ ç»Ÿå¼•å…¥æ–¹å¼ï¼š`script` æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./dist/main.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    demo ç¤ºä¾‹</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    demo.getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€HTML ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/9.png" class="">

<p>ç»“æœï¼šæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®å…¨å±€å¯¹è±¡çš„ <code>demo</code> å±æ€§ã€‚</p>
<blockquote>
<p>é€šå¸¸è®¨è®ºå…¨å±€å¯¹è±¡æ—¶ï¼Œå¾ˆå°‘ä¼šåŒºåˆ†å…¨å±€å¯¹è±¡æ˜¯ global å¯¹è±¡ï¼Œè¿˜æ˜¯ global å¯¹è±¡ä¸Šçš„å±æ€§ã€‚ç”±äºä½œç”¨åŸŸé“¾çš„åŸå› ï¼Œglobal å¯¹è±¡ä¸Šçš„å±æ€§éƒ½å¯ä»¥ç›´æ¥åœ¨å…¨å±€è®¿é—®ã€‚ä¸åŒçš„ JavaScript ç¯å¢ƒå­˜åœ¨ä¸åŒçš„å…¨å±€å¯¹è±¡ï¼Œä¾‹å¦‚æµè§ˆå™¨ä¸­çš„ <code>window</code>ã€<code>self</code>ã€<code>location</code>ã€<code>navigator</code>ã€<code>event</code>ï¼ŒNode.js ä¸­çš„ <code>global</code>ã€<code>module</code>ã€<code>exports</code>ã€<code>process</code> ç­‰ã€‚è®¿é—®å®¿ä¸»ç¯å¢ƒä¸­ä¸å­˜åœ¨çš„å…¨å±€å˜é‡ä¼šäº§ç”Ÿ <code>ReferenceError</code> é”™è¯¯ï¼ˆå³è®¿é—®æœªå£°æ˜å˜é‡ï¼‰ã€‚</p>
</blockquote>
<p><strong>ä¸¾ä¾‹å­ğŸŒ°</strong></p>
<p>å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° <code>global</code> å¯¹è±¡ä¸­ã€‚</p>
<p>webpack-config-global-cover.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-global-cover.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `global` å¯¹è±¡ä¸­</span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;global&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>packge.js æ–‡ä»¶ <code>script</code> å­—æ®µæ·»åŠ  æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-global-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-global-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-<span class="built_in">global</span>-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…åçš„æ–‡ä»¶ <code>webpack-global-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> r)</span><br><span class="line">        e[o] = r[o];</span><br><span class="line">    r.__esModule &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(self, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>index-global-cover.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-global-cover.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    global é…ç½®</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `global` å¯¹è±¡ä¸­</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨æ‰“å¼€HTML, ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/9.png" class="">

<p>ç”±æˆªå›¾å…‹åˆ¶ï¼š æ¨¡å—è¿”å›å€¼çš„ <code>getName</code>å±æ€§ç›´æ¥åˆ†é…åˆ°äº†å…¨å±€å¯¹è±¡ä¸Šï¼Œæ‰€æœ‰æˆ‘ä»¬æ‰èƒ½ç›´æ¥æ‰§è¡Œ <code>getName()</code></p>
<h3 id="libraryTarget-â€commonjsâ€"><a href="#libraryTarget-â€commonjsâ€" class="headerlink" title="libraryTarget: â€commonjsâ€"></a>libraryTarget: â€commonjsâ€</h3><p>å°†æ¨¡å—çš„è¿”å›å€¼åˆ†é…ç»™ <code>exports</code> å¯¹è±¡çš„å±æ€§ä¸Šï¼Œ è¿™ä¸ªå±æ€§ç”± <code>output.library</code> æŒ‡å®šï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§å°†ç›´æ¥åˆ†é…åˆ° <code>exports</code> å¯¹è±¡ä¸Šï¼ˆå¹¶ä¸”<code>webpack</code>å¹¶ä¸ä¼šæ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŸäº›å±æ€§è®¾ç½®ï¼Œå³ä¼šå‘ç”Ÿè¦†ç›–è¡Œä¸ºï¼‰</p>
<p>ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå½“æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œé‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼ä¼šè¢«åˆ†é…åˆ° <code>window</code> å¯¹è±¡çš„ å±æ€§ï¼ˆlibraryå†³å®šå±æ€§ï¼‰ä¸Š ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_:æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="built_in">exports</span>[<span class="string">&quot;demo&quot;</span>] = _entry_return_;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>æ·»åŠ æ–°çš„é…ç½®æ–‡ä»¶ <code>webpack-config-global.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>:<span class="string">&#x27;webpack-commonjs.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼åˆ†é…ç»™ `exports` å¯¹è±¡çš„å±æ€§ä¸Šï¼Œ è¿™ä¸ªå±æ€§ç”± `output.library` æŒ‡å®š</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;commonjs&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>packge.js æ–‡ä»¶ <code>script</code> å­—æ®µæ·»åŠ  æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-commonjs&quot;</span>: <span class="string">&quot;webpack --config webpack-config-commonjs.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-commonjs</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>webpack-commonjs.js</code>ï¼›</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»æ‰“åŒ…ç»“æœå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬çš„ æ¨¡å— <code>demo</code> æŒ‚è½½åœ¨äº† <code>exports</code> å¯¹è±¡ä¸Š</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>å¼•ç”¨çš„è¯ï¼Œéœ€è¦åœ¨ CommonJS ç¯å¢ƒä¸­</p>
<p>åœ¨ <code>src</code> ç›®å½•ä¸­æ·»åŠ  <code>test-commonjs.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> my_export = <span class="built_in">require</span>(<span class="string">&#x27;./dist/main.js&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> demo = my_export.demo;</span><br><span class="line"><span class="built_in">console</span>.log(demo)</span><br><span class="line">demo.getName();</span><br></pre></td></tr></table></figure>

<p> ç„¶åæˆ‘ä»¬åœ¨ CommonJS ç¯å¢ƒä¸‹æ‰§è¡Œè¿™ä¸ªä»£ç ï¼ˆå¯ä»¥åœ¨ vscode ç¼–è¾‘å™¨ä¸­æ‰§è¡Œï¼Œå®‰è£…run-code æ’ä»¶å°±å¯ä»¥æ‰§è¡Œ); </p>
<p>æ‰§è¡Œçš„ç»“æœä¸ºï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/11.png" class="">



<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° <code>exports</code> å¯¹è±¡ä¸­ã€‚</p>
<p>webpack-config-commonjs-cover.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-commonjs-cover.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ° `exports` å¯¹è±¡ä¸­ã€‚</span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;commonjs&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>packge.js æ–‡ä»¶ <code>script</code> å­—æ®µæ·»åŠ  æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-commonjs-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-commonjs-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-commonjs-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ï¼ˆdist/webpack-commonjs-cover.jsï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> r)</span><br><span class="line">        e[o] = r[o];</span><br><span class="line">    r.__esModule &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(<span class="built_in">exports</span>, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç»“æœè¯´æ˜ï¼šæ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ°å¯¹è±¡ <code>export</code> ä¸­</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>src/test-commonjs-cover.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> demo = <span class="built_in">require</span>(<span class="string">&#x27;../dist/webpack-commonjs-cover.js&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(demo)</span><br><span class="line">demo.getName()</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/12.png" class="">

<p>å¯ä»¥çœ‹å‡ºæ¥:<code>require</code> çš„ç»“æœå°±æ˜¯ <code>demo</code>æ¨¡å—æœ¬èº«ï¼Œå¯çŸ¥æ²¡æœ‰è®¾ç½® library çš„å€¼ï¼Œé‚£ä¹ˆå°†æ¨¡å—è¿”å›å€¼çš„æ‰€æœ‰å±æ€§éƒ½åˆ†é…åˆ°å¯¹è±¡ <code>export</code> ä¸­</p>
<hr>
<h2 id="æ¨¡å—å®šä¹‰ç³»ç»Ÿ"><a href="#æ¨¡å—å®šä¹‰ç³»ç»Ÿ" class="headerlink" title="æ¨¡å—å®šä¹‰ç³»ç»Ÿ"></a>æ¨¡å—å®šä¹‰ç³»ç»Ÿ</h2><p>è¿™äº›é€‰é¡¹å°†äº§ç”Ÿä¸€ä¸ªåŒ…å«æ›´å®Œæ•´å…¼å®¹ä»£ç çš„åŒ…ï¼Œä»¥ç¡®ä¿å„ä¸ªæ¨¡å—ç³»ç»Ÿçš„å…¼å®¹æ€§ã€‚è¿™æ—¶å€™ <code>output.library</code> é€‰é¡¹åœ¨ä¸åŒçš„ <code>output.libraryTarget</code>é€‰é¡¹ä¸­å…·æœ‰ä¸åŒçš„å«ä¹‰ã€‚</p>
<h3 id="libraryTarget-â€œcommonjs2â€"><a href="#libraryTarget-â€œcommonjs2â€" class="headerlink" title="libraryTarget: â€œcommonjs2â€"></a>libraryTarget: â€œcommonjs2â€</h3><p>è¿™ä¸ªé€‰é¡¹é…ç½®æ˜¯æŒ‡å°†æ¨¡å—çš„è¿”å›å€¼ï¼ˆå…¥å£çš„è¿”å›å€¼ï¼‰åˆ†é…ç»™ <code>module.exports</code>å¯¹è±¡ä¸Šçš„å±æ€§ï¼Œ è¿™ä¸ªå±æ€§ç”±<code>library</code>æŒ‡å®š; å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œæ¨¡å—çš„è¿”å›å€¼ç›´æ¥åˆ†é…ç»™ <code>module.exports </code>å¯¹è±¡ã€‚</p>
<p>æ­£å¦‚åå­—æ‰€æŒ‡å¯ä»¥åœ¨ä½¿ç”¨åœ¨ <code>CommonJS</code> ç¯å¢ƒã€‚</p>
<blockquote>
<p>æœ‰æ²¡æœ‰å‘ç°commonjs å’Œ commonjs2 é•¿çš„å¾ˆåƒï¼Ÿ å…¶å®ä»–ä»¬ç¡®å®å¾ˆç›¸ä¼¼ï¼Œ ä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å¾ˆå¾®å¦™çš„åŒºåˆ«çš„ï¼Œå¯ä»¥ç‚¹å‡»è¿™ä¸ª <a target="_blank" rel="noopener" href="https://github.com/webpack/webpack/issues/1114">issue</a> äº†è§£äº†è§£</p>
</blockquote>
<p>ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå½“æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œé‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼ä¼šè¢«åˆ†é…ç»™ <code>module.exports</code>å¯¹è±¡ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_: æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">// æ‰“åŒ…æ–¹å¼ç»“æœ</span></span><br><span class="line"><span class="built_in">module</span>.exports = _entry_return_;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ–¹å¼: ä½¿ç”¨åŠ è½½å™¨æ¥ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// å¦‚ï¼šåœ¨commonJS ç¯å¢ƒä¸­ä½¿ç”¨ require æ¥åŠ è½½æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> demo = <span class="built_in">require</span>(<span class="string">&quot;demo&quot;</span>);</span><br><span class="line">demo.getName();</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä¸‹<code>output.library</code> ä¸èƒ½ä¸ <code>output.libraryTarget</code> ä¸€èµ·ä½¿ç”¨ã€‚å³ä½¿ä½¿ç”¨ä¹Ÿä¼šè¢«å¿½ç•¥æ‰ã€‚å…·ä½“åŸå› è¯·å‚ç…§<a target="_blank" rel="noopener" href="https://github.com/webpack/webpack/issues/11800">æ­¤ issue</a>ã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<ul>
<li>æ¨¡å—çš„è¿”å›å€¼ï¼ˆå…¥å£çš„è¿”å›å€¼ï¼‰åˆ†é…ç»™ <code>module.exports</code>å¯¹è±¡ä¸Šçš„å±æ€§, è¿™ä¸ªå±æ€§ç”±<code>library</code>æŒ‡å®š</li>
</ul>
<p>æ–°åŠ é…ç½®æ–‡ä»¶ <code>webpack-config-commonjs2.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">library</span>:<span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;commonjs2&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-commonjs2&quot;</span>: <span class="string">&quot;webpack --config webpack-config-commonjs2.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæˆ‘ä»¬æ–°æ‰“åŒ…çš„å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-commonjs2</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>dist/webpack-commonjs2.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports.demo = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,o,r</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            r.r(o),</span><br><span class="line">            r.d(o, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , o = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o[t])</span><br><span class="line">            <span class="keyword">return</span> o[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = o[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, r),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r.d = <span class="function">(<span class="params">e,o</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> o)</span><br><span class="line">            r.o(o, t) &amp;&amp; !r.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: o[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r.o = <span class="function">(<span class="params">e,o</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, o),</span><br><span class="line">    r.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    r(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœå¯ä»¥çœ‹å‡ºæ¥ï¼šæˆ‘ä»¬çš„æ¨¡å— <code>demo</code>æŒ‚è½½åœ¨æˆ‘ä»¬çš„<code>nodule.exports</code> å¯¹è±¡ä¸Šã€‚</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>å¯ä»¥ä½¿ç”¨åŠ è½½å™¨æ¥åŠ è½½æ¨¡å—ä½¿ç”¨ï¼›å¦‚ requireJSç­‰</p>
<p><code>src/test-commonjs2.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> my_module_exports = <span class="built_in">require</span>(<span class="string">&#x27;../dist/webpack-commonjs2.js&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> demo = my_module_exports.demo;</span><br><span class="line"><span class="built_in">console</span>.log(my_module_exports);</span><br><span class="line"><span class="built_in">console</span>.log(demo);</span><br><span class="line">demo.getName()</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ:</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/13.png" class="">

<p>ç»“æœè¯´æ˜ï¼šæˆ‘ä»¬çš„ <code>demo</code>æ¨¡å— æŒ‚è½½åœ¨äº† <code>nodule.exports</code>å¯¹è±¡ä¸Š</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p>å¦‚æœæ²¡æœ‰æŒ‡å®š <code>library</code>ï¼Œ é‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼å°†ç›´æ¥åˆ†é…åˆ° <code>module.exports</code>ä¸Šã€‚</p>
<p><code>webpack-config-commonjs2-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-commonjs2-cover.js&#x27;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰æŒ‡å®š `library`ï¼Œ é‚£ä¹ˆæ¨¡å—çš„è¿”å›å€¼å°†ç›´æ¥åˆ†é…åˆ° `module.exports`ä¸Šã€‚</span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;commonjs2&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-commonjs2-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-commonjs2-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæˆ‘ä»¬æ–°æ‰“åŒ…çš„å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-commonjs2-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>dist/webpack-commonjs2-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼š å¯ä»¥çœ‹å‡ºæ¥ï¼Œ æˆ‘ä»¬æ¨¡å—çš„è¿”å›å€¼ç›´æ¥åˆ†é…ç»™äº† <code>module.exports</code>ã€‚</p>
<p><strong>ä½¿ç”¨æ¨¡å—</strong></p>
<p><code>src/test-commonjs2-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> demo = <span class="built_in">require</span>(<span class="string">&#x27;../dist/webpack-commonjs2-cover.js&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(demo);</span><br><span class="line">demo.getName()</span><br></pre></td></tr></table></figure>

<p>åœ¨ commonJSç¯å¢ƒä¸­æ‰§è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/14.png" class="">

<p>ç»“æœè¯´æ˜ï¼š æˆ‘ä»¬<code>require</code>dçš„ç»“æœå°±æ˜¯ <code>demo</code>æ¨¡å—æœ¬èº«ã€‚</p>
<hr>
<h3 id="libraryTarget-â€œamdâ€"><a href="#libraryTarget-â€œamdâ€" class="headerlink" title="libraryTarget: â€œamdâ€"></a>libraryTarget: â€œamdâ€</h3><p>è¿™ä¸ªé€‰é¡¹å°†æ¨¡å—çš„è¿”å›å€¼ä½œä¸º <code>AMD</code>æ¨¡å—å¯¼å‡ºã€‚<code>AMD</code>æ¨¡å—è¦æ±‚è¾“å…¥è„šæœ¬è¢«å®šä¹‰ä¸ºå…·æœ‰ç‰¹å®šå±æ€§ï¼Œé€šå¸¸é€šè¿‡ RequireJS æˆ–è€…ä»»ä½•çš„åŠ è½½å™¨ï¼ˆä¾‹å¦‚almondï¼‰æä¾›çš„ <code>reuqire</code> å’Œ <code>define</code>å±æ€§ã€‚å¦åˆ™ç›´æ¥åŠ è½½ç”Ÿæˆçš„AMD æ¨¡å—æ†ç»‘åŒ…å°†ä¼šå¯¼è‡´ <code>define is not defined</code>çš„é”™è¯¯ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>è¿™ä¸€å°èŠ‚çš„å†…å®¹å’Œç½‘ä¸Šçš„æ–‡ç« ä¼šæœ‰æ‰€ä¸åŒï¼Œé‚£æ˜¯å› ä¸º <code>webpack</code> ç‰ˆæœ¬çš„åŸå› ã€‚ ç½‘ä¸Šçš„æ•™ç¨‹çš„ webpack4 ä»¥ä¸‹ç‰ˆæœ¬ï¼Œ æˆ‘ä»¬è¿™ä¸ªæ˜¯ webpack5.19.1 ç‰ˆæœ¬çš„ï¼Œ æ˜¯æœ‰ä¸€äº›ä¸ä¸€æ ·çš„ã€‚</p>
<p>å¦‚æœå®šä¹‰äº†<code>output.library</code>ï¼Œæ‰“åŒ…å®šä¹‰æˆçš„ä»£ç å°†ä¼šæ˜¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _entry_return_ï¼š æ¨¡å—çš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">// æ‰“åŒ…æ–¹å¼çš„ç»“æœ</span></span><br><span class="line">define(<span class="string">&#x27;demo&#x27;</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) =&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> _entry_return_;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>output.library</code>æ²¡æœ‰å®šä¹‰æœ‰æ•ˆå€¼ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ä»£ç å°†å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> _entry_return_;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å»ºè®®æ˜¯ä½¿ç”¨ä¸å®šä¹‰ <code>output.library</code>å€¼</p>
</blockquote>
<p>ä½¿ç”¨å¯ä»¥é€šè¿‡ æ¨¡å—åŠ è½½å™¨æ¥åŠ è½½ä½¿ç”¨ï¼ˆå…·ä½“ä½¿ç”¨æ–¹å¼çœ‹ä¸‹é¢çš„ä¾‹å­ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">&#x27;demo&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">myDemo</span>) </span>&#123;</span><br><span class="line"> <span class="comment">//... dosomething</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<ul>
<li><code>output.library</code>æ²¡æœ‰å®šä¹‰æœ‰æ•ˆå€¼</li>
</ul>
<p><code>webpack-config-amd-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-amd-cover.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ²¡æœ‰å®šä¹‰ library </span></span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;amd&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-amd-cover&quot;</span>: <span class="string">&quot;webpack --config webpack-config-amd-cover.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-amd-cover</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>dist/webpack-amd-cover.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">define((<span class="function">()=&gt;</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,t</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            t.r(r),</span><br><span class="line">            t.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>o</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[o])</span><br><span class="line">            <span class="keyword">return</span> r[o].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[o] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[o](n, n.exports, t),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> r)</span><br><span class="line">            t.o(r, o) &amp;&amp; !t.o(e, o) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, o, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[o]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    t.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    t.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    t(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)()));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>æˆ‘ä»¬çŸ¥é“ AMD æ¨¡å— æ˜¯ä¸ºäº†èƒ½åœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ åŠ è½½å™¨æ¥åŠ è½½ä½¿ç”¨ï¼ˆrequireJSç­‰åŠ è½½å™¨ï¼‰</p>
<p><code>src/index-amd-cover.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>AMD æ¨¡å—çš„å¼•ç”¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å¼•å…¥require.jså¹¶æŒ‡å®šjsä¸»æ–‡ä»¶çš„å…¥å£ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://requirejs.org/docs/release/2.3.6/minified/require.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>([<span class="string">&#x27;../dist/webpack-amd-cover.js&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">demo</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(demo,<span class="string">&#x27;åŠ è½½å®Œæˆäº†&#x27;</span>)</span></span><br><span class="line"><span class="javascript">      &#125;)</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    amd é…ç½®:</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ²¡æœ‰å®šä¹‰äº† output.library çš„å€¼</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€HTMLæ–‡ä»¶ï¼Œ ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/15.png" class="">

<blockquote>
<p>æ³¨æ„ï¼š æ²¡æœ‰å®šä¹‰ library çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åŠ è½½å®Œ æ¨¡å—ä¹‹åï¼Œ æ˜¯å¯ä»¥å¾—åˆ°æ¨¡å—ï¼ˆhtml çš„ demo å‚æ•°æ˜¯æœ‰å€¼çš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯å¯ä»¥ä½¿ç”¨æ¨¡å—çš„ï¼Œ ä½†æ˜¯å®šä¹‰äº† library å°±å–ä¸åˆ°äº†ï¼Œ</p>
</blockquote>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<ul>
<li><code>output.library</code>å®šä¹‰æœ‰æ•ˆå€¼</li>
</ul>
<p><code>webpack-config-amd.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-amd.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// library å®šä¹‰æœ‰æ•ˆå€¼</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;amd&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-amd&quot;</span>: <span class="string">&quot;webpack --config webpack-config-amd.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæˆ‘ä»¬æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-amd</span><br></pre></td></tr></table></figure>



<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶<code>dist/webpack-amd.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&quot;demo&quot;</span>, [], (<span class="function">()=&gt;</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="number">138</span>: <span class="function">(<span class="params">e,r,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            o.r(r),</span><br><span class="line">            o.d(r, &#123;</span><br><span class="line">                <span class="attr">getName</span>: <span class="function">()=&gt;</span>t</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r[t])</span><br><span class="line">            <span class="keyword">return</span> r[t].exports;</span><br><span class="line">        <span class="keyword">var</span> n = r[t] = &#123;</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[t](n, n.exports, o),</span><br><span class="line">        n.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.d = <span class="function">(<span class="params">e,r</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> r)</span><br><span class="line">            o.o(r, t) &amp;&amp; !o.o(e, t) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, t, &#123;</span><br><span class="line">                <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                <span class="attr">get</span>: r[t]</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o.o = <span class="function">(<span class="params">e,r</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, r),</span><br><span class="line">    o.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    o(<span class="number">138</span>)</span><br><span class="line">&#125;</span><br><span class="line">)()));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœè¯´æ˜ï¼šæ¨¡å—çš„è¿”å›å€¼ä½œä¸º AMD æ¨¡å—å¯¼å‡ºã€‚</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<p>æˆ‘ä»¬çŸ¥é“ AMD æ¨¡å— æ˜¯ä¸ºäº†èƒ½åœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ åŠ è½½å™¨æ¥åŠ è½½ä½¿ç”¨ï¼ˆrequireJSç­‰åŠ è½½å™¨ï¼‰</p>
<p><code>src/index-amd.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>AMD æ¨¡å—çš„å¼•ç”¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å¼•å…¥require.jså¹¶æŒ‡å®šjsä¸»æ–‡ä»¶çš„å…¥å£ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://requirejs.org/docs/release/2.3.6/minified/require.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>([<span class="string">&#x27;../dist/webpack-amd.js&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">demo</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(demo,<span class="string">&#x27;åŠ è½½å®Œæˆäº†&#x27;</span>)</span></span><br><span class="line"><span class="javascript">      &#125;)</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    amd é…ç½®:</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å®šä¹‰äº† output.library çš„å€¼</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæˆ‘ä»¬çš„ HTML æ–‡ä»¶ï¼Œ ç»“æœæ˜¯æ‰“å°å‡ºï¼š undefined â€œåŠ è½½å®Œæˆäº†â€</p>
<blockquote>
<p>æ³¨æ„ï¼š ä½¿ç”¨å®šä¹‰äº† library å€¼çš„æ¨¡å—ï¼Œ æˆ‘ä»¬åœ¨æ¨¡å—åŠ è½½ä¹‹åæ˜¯å›è°ƒå‚æ•°æ˜¯ undefinedã€‚æ²¡æ³•ä½¿ç”¨æ¨¡å—ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œçœ‹è‡ªå·±çš„åœºæ™¯æ¥ä½¿ç”¨å§ã€‚</p>
</blockquote>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<h3 id="libraryTarget-â€œumdâ€"><a href="#libraryTarget-â€œumdâ€" class="headerlink" title="libraryTarget: â€œumdâ€"></a>libraryTarget: â€œumdâ€</h3><p>è¿™ä¸ªé€‰é¡¹è¡¨ç¤ºå°†æ¨¡å—çš„è¿”å›å€¼å¯¼å‡ºä¸º<code> AMDæ¨¡å¼</code> å’Œ å¯¼å‡ºåˆ°<code>global å¯¹è±¡</code>ä¸Šï¼Œæ‰€ä»¥å®ƒèƒ½åœ¨ AMD ç¯å¢ƒä¸­è¿è¡Œã€åœ¨æµè§ˆå™¨å……å½“å…¨å±€å¯¹è±¡çš„å±æ€§ã€‚</p>
<p>æ³¨æ„ï¼š è¿™æ—¶å€™çš„library æ˜¯å¿…é¡»çš„ã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ğŸŒ°</strong></p>
<p><code>webpack-config-umd.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;webpack-umd.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ¨¡å—çš„è¿”å›å€¼å¯¼å‡ºä¸º` AMDæ¨¡å¼` å’Œ å¯¼å‡ºåˆ°`global å¯¹è±¡`ä¸Šï¼Œæ‰€ä»¥å®ƒèƒ½åœ¨ AMD ç¯å¢ƒä¸­è¿è¡Œã€åœ¨æµè§ˆå™¨å……å½“å…¨å±€å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;demo&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;umd&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json æ·»åŠ æ–°çš„æ‰“åŒ…å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build-umd&quot;</span>: <span class="string">&quot;webpack --config webpack-config-umd.js&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ–°çš„æ‰“åŒ…æ–¹å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npon run build-umd</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶ <code>dist/webpack-umd.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e, o</span>) </span>&#123;</span><br><span class="line">    <span class="string">&quot;object&quot;</span> == <span class="keyword">typeof</span> <span class="built_in">exports</span> &amp;&amp; <span class="string">&quot;object&quot;</span> == <span class="keyword">typeof</span> <span class="built_in">module</span> ? <span class="built_in">module</span>.exports = o() : <span class="string">&quot;function&quot;</span> == <span class="keyword">typeof</span> define &amp;&amp; define.amd ? define([], o) : <span class="string">&quot;object&quot;</span> == <span class="keyword">typeof</span> <span class="built_in">exports</span> ? <span class="built_in">exports</span>.demo = o() : e.demo = o()</span><br><span class="line">&#125;(self, (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> e = &#123;</span><br><span class="line">            <span class="number">138</span>: <span class="function">(<span class="params">e,o,t</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">&quot;shuliqi&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                t.r(o),</span><br><span class="line">                t.d(o, &#123;</span><br><span class="line">                    <span class="attr">getName</span>: <span class="function">()=&gt;</span>r</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">          , o = &#123;&#125;;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">r</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (o[r])</span><br><span class="line">                <span class="keyword">return</span> o[r].exports;</span><br><span class="line">            <span class="keyword">var</span> n = o[r] = &#123;</span><br><span class="line">                <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> e[r](n, n.exports, t),</span><br><span class="line">            n.exports</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t.d = <span class="function">(<span class="params">e,o</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r <span class="keyword">in</span> o)</span><br><span class="line">                t.o(o, r) &amp;&amp; !t.o(e, r) &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, r, &#123;</span><br><span class="line">                    <span class="attr">enumerable</span>: !<span class="number">0</span>,</span><br><span class="line">                    <span class="attr">get</span>: o[r]</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        ,</span><br><span class="line">        t.o = <span class="function">(<span class="params">e,o</span>)=&gt;</span><span class="built_in">Object</span>.prototype.hasOwnProperty.call(e, o),</span><br><span class="line">        t.r = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="built_in">Symbol</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag &amp;&amp; <span class="built_in">Object</span>.defineProperty(e, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">                <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span></span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(e, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">                <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        ,</span><br><span class="line">        t(<span class="number">138</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    )()</span><br><span class="line">&#125;</span><br><span class="line">));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…ç»“æœï¼šå°è£…äº†ä¸¤ç§æ¨¡å¼ï¼ˆamd å’Œ globalï¼‰è¿™ä¸¤ç§æ–¹å¼</p>
<p><strong>å¼•ç”¨æ¨¡å—</strong></p>
<ul>
<li>åŠ è½½å™¨åŠ è½½ä½¿ç”¨(requireJS)</li>
</ul>
<p><code>src/index-umd.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>umd ä½¿ç”¨ requireJs åŠ è½½å™¨åŠ è½½<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- å¼•å…¥require.jså¹¶æŒ‡å®šjsä¸»æ–‡ä»¶çš„å…¥å£ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://requirejs.org/docs/release/2.3.6/minified/require.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>([<span class="string">&#x27;../dist/webpack-umd.js&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">demo</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(demo);</span></span><br><span class="line"><span class="javascript">        demo.getName()</span></span><br><span class="line"><span class="javascript">      &#125;)</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    umd é…ç½®:</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ä½¿ç”¨ requireJs åŠ è½½å™¨åŠ è½½</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨æ‰“å¼€ html æ–‡ä»¶ï¼Œ ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/16.png" class="">

<p>ç»“æœè¯´æ˜ï¼šåŠ è½½æˆ‘ä»¬çš„æ¨¡å—ä¹‹åï¼Œ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„æ¨¡å—ï¼ˆ<code>demo.getName()</code>ï¼‰</p>
<ul>
<li>scriptæ ‡ç­¾ æ–¹å¼å¼•å…¥</li>
</ul>
<p><code>index-umd-cover.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>umdé…ç½®: script æ ‡ç­¾å¼•å…¥æ–¹å¼<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¼ ç»Ÿé“¶åœŸæ–¹å¼ï¼šscript æ ‡ç­¾å¼•å…¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;../dist/webpack-umd.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    umdé…ç½®: </span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    script æ ‡ç­¾å¼•å…¥æ–¹å¼</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  demo.getName();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€htmlï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/2021/02/03/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9Alibrary%EF%BC%8ClibraryTarget%EF%BC%8CauxiliaryComment/17.png" class="">

<p>è¯´æ˜ï¼š<code>demo</code> æ¨¡å—æ˜¯æŒ‚è½½åœ¨å…¨å±€å˜é‡ä¸Šé¢äº†ï¼Œ æˆ‘ä»¬æ‰å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>demo.getName()</code></p>
<hr>
<p>å‰©ä¸‹è¿˜æœ‰ä¸¤ä¸­æš´éœ²æ–¹å¼ï¼ˆæš´éœ²<code>jsonp</code>ï¼Œæš´éœ²ä¸º<code> system</code>ï¼‰ï¼Œ æˆ‘è‡ªå·±æ²¡æ€ä¹ˆçœ‹æ‡‚å¦‚ä½•ä½¿ç”¨ï¼Œç­‰æˆ‘æ‡‚çš„æ—¶å€™å†è¡¥å……ä¸Šæ¥å§ï¼ï¼</p>
<p>ä¸Šé¢çš„ä¾‹å­ çš„æ‰€æœ‰ä»£ç éƒ½æ˜¯ ä¸Šä¼ åˆ° <code>github</code> ä¸Š<a target="_blank" rel="noopener" href="https://github.com/shuliqi/webpack-libraryTarget">webpack-libraryTarget</a>ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œ å¯ä»¥ä¸‹è½½ã€‚</p>
<h2 id="å‚è€ƒæ–‡ç« ï¼š"><a href="#å‚è€ƒæ–‡ç« ï¼š" class="headerlink" title="å‚è€ƒæ–‡ç« ï¼š"></a>å‚è€ƒæ–‡ç« ï¼š</h2><p><a target="_blank" rel="noopener" href="https://www.xlaoyu.info/2018/01/05/webpack-output-librarytarget/">è¯¦è§£webpackçš„out.libraryTargetå±æ€§</a></p>
<p><a target="_blank" rel="noopener" href="https://webpack.docschina.org/configuration/output/#outputlibrarytarget">output.libraryTarget </a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903618081095688">ã€æ·±å…¥ç†è§£webpackã€‘library,libraryTarget,externalsçš„åŒºåˆ«åŠä½œç”¨</a></p>
<!-- flag of hidden posts --></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">èˆ’å°ç¦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://shuliqi.github.io/2021/02/03/webpackå­¦ä¹ ç¬”è®°ï¼šlibraryï¼ŒlibraryTargetï¼ŒauxiliaryComment/">https://shuliqi.github.io/2021/02/03/webpackå­¦ä¹ ç¬”è®°ï¼šlibraryï¼ŒlibraryTargetï¼ŒauxiliaryComment/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://shuliqi.github.io">èˆ’å°ç¦çš„Blog</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">webpackå­¦ä¹ ç¬”è®°</a></div><nav id="pagination"></nav></div></div><footer class="footer-bg" style="background-image: url(/webp.webp)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By èˆ’å°ç¦</div><div class="framework-info"><span>é©±åŠ¨ - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>