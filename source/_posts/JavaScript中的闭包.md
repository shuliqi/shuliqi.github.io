---
title: JavaScript中的闭包
date: 2021-05-31 10:49:48
tags: JavaScript
categories: JavaScript
---

对于使用过`JavaScript`的人来说，理解闭包的概念是需要付出非常多的努力和牺牲的。其实很多人在没有理解必闭包之前也已经使用了闭包，但是我们应该根据自己的意愿来正确的识别和使用闭包，这边文章主要是在我看了《你不知道的JavaScript》之后整理的。供自己以后方便查阅。

在理解闭包之前首先得先理解一下**词法作用域**

# 作用域

作用域简单的可以说： 作用域的本质是一套规则，规定了变量的生命周期和可使用范围。

《你不知道的JavaScript上卷》上是这么说的：

> 作用域就是一套设计良好的规则来存储变量，并且之后可以方便的找到这些变量



作用域的解析方式有两种： 

- 词法作用域
- 动态作用域

而`JavaScript`使用的是词法作用域。下面我们来讲词法作用域

# 词法作用域

词法作用域也叫静态作用域， 它的作用域在词法分析阶段的时候就已经确定了。是不会再改变了。词法作用域是由你在写代码的时候将变量和代码写在哪里来决定的。这样词法分析器在处理代码的时候就会保持作用域不变。

而作用域根据代码层次分层，子域可以访问到父作用域，通常沿着链式作用域查找，而父作用域是不能访问子作用域的。

我们看个例子：

```javascript
var a = 10;
function foo() {
  var a = 20;
  console.log(a);
}
foo();
```

在词法作用域下：

- 全局作用域有两个标识:  a,  foo
- foo函数作用域下有一个标识： a

执行`foo()`的时候， `console.log(a)`是在 foo函数作用域下的，并且里面有 a 变量的标识， 所以输出的是 20 而不是 10

我们举个例子：

```javascript
var a = 10;
function getA() {
    console.log(a);
}
function foo() {
    var a = 20;
    getA();
}
foo();
```

在词法作用域下：

- 全局作用域两个标识：a，getA,  foo,
- 在 foo 函数这个作用域下有一个标识： a

执行 `foo `函数的时候，`getA()` 被执行。但是`getA()`是定义在全局作用域下的，所以获取到的值是10， 而不是20

# 闭包

我们先看闭包的定义，要先掌握它才能更加理解是识别闭包：

>当函数可以记住和访问当前的词法作用域时，就产生了闭包。即使这个函数是在当前的词法作用域之外执行的。

我们来看一段代码：

```
```

































